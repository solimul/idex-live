<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>iDex • a Lightweight DEX</title>
  <style>
    :root {
      --bg: #0b0f14;
      --card: rgba(255,255,255,0.06);
      --card-border: rgba(255,255,255,0.08);
      --muted: #9bb3c7;
      --text: #e6eef6;
      --accent: #7cc8ff;
      --accent-2: #6ee7b7;
      --danger: #ef4444;
      --warning: #f59e0b;
      --success: #22c55e;
      --radius: 16px;
    }
    body {
      margin: 0; background: var(--bg); color: var(--text);
      font-family: Inter, sans-serif;
    }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 24px; }
    header { display:flex; justify-content:space-between; margin-bottom: 20px; }
    .kpis { display:grid; grid-template-columns: repeat(5,1fr); gap: 12px; margin-bottom: 20px; }
    .kpi { background: var(--card); border:1px solid var(--card-border); border-radius: var(--radius); padding: 14px; }
    .kpi .title { font-size: 12px; color: var(--muted); margin-bottom: 4px; }
    .kpi .value { font-size: 16px; font-weight: bold; }

    nav.menu { display:flex; justify-content:center; gap:24px; margin-bottom: 20px; }
    nav.menu a { color: var(--muted); text-decoration:none; font-weight:500; }
    nav.menu a.active { color: var(--accent); border-bottom: 2px solid var(--accent); padding-bottom: 2px; }

    .card { background: var(--card); border: 1px solid var(--card-border); border-radius: var(--radius); padding: 20px; margin: 0 auto; max-width: 800px; }
    .card h2 { margin-top:0; margin-bottom: 16px; }
    .row { display:flex; gap: 16px; margin-bottom: 14px; }
    .col { flex:1; display:flex; flex-direction:column; }
    .label { font-size: 12px; margin-bottom:6px; color: var(--muted); }
    .input, select { padding: 12px; border-radius: 12px; border:1px solid var(--card-border); background: rgba(10,13,18,.6); color: var(--text); }
    .btn { padding: 10px 16px; border-radius: 10px; border:1px solid var(--card-border); background: var(--card); cursor:pointer; color:var(--text); }
    .btn.primary { background: linear-gradient(135deg, rgba(124,200,255,.15), rgba(110,231,183,.15)); border-color: var(--accent); }
    .section { margin-bottom: 20px; padding-bottom: 12px; border-bottom: 1px solid rgba(255,255,255,0.08); }
    .section:last-child { border-bottom: none; }
    .status { margin-top: 8px; font-size: 16px; color: var(--muted); white-space: pre-wrap; max-height: 160px; overflow:auto; text-align:center; font-weight: bold; }
    .hidden {display: none;}
    .ok {color: green;}
    .err {color:red;}
    .wrn {color: orange;}
    .span {margin-right: 10px; margin-top:10px;}
    .chain {font-weight: bold;}
    .title {color:green; margin-top:20px;}
    .footer {
      margin-top: 40px;
      padding: 16px;
      text-align: center;
      font-size: 13px;
      color: var(--muted);
      border-top: 1px solid var(--card-border);
      background: rgba(255, 255, 255, 0.02);
      border-radius: var(--radius) var(--radius) 0 0;
    }

    .footer a {
      color: var(--accent);
      text-decoration: none;
      margin-left: 4px;
    }

    .footer a:hover {
      text-decoration: underline;
    }  
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1 class="title">iDex: a lightweight decentralized exchange</h1>
      <div style="margin-top:25px;">
        <span class="span chain" id="chain"></span>
        <button class="btn primary" id="btnConnect">Connect Wallet</button>
      </div>
    </header>

    <!-- KPI -->
    <div class="kpis">
      <div class="kpi"><div class="title">USDC Reserve</div><div class="value" id="kpiUsdc">–</div></div>
      <div class="kpi"><div class="title">ETH Reserve</div><div class="value" id="kpiEth">–</div></div>
      <div class="kpi"><div class="title">Accrued Swap Fees</div><div class="value" id="kpiSwapFees">–</div> <div class="title"> USDC / ETH </div></div>
      <div class="kpi"><div class="title">Price (USDC→ETH)</div><div class="value" id="kpiPrice">–</div></div>
      <div class="kpi"><div class="title">Your UELP</div><div class="value" id="kpiUelp">–</div></div>
    </div>

    <!-- Menu -->
    <nav class="menu">
      <a href="#" class="active" data-target="swap">Swap</a>
      <a href="#" data-target="liquidity">Liquidity Mgmt</a>
      <a href="#" data-target="admin">Admin</a>
      <a href="#" data-target="about">About iDex</a>

    </nav>

    <div class="section">
      <div id="status" class="status hidden"></div>
    </div>
    <!-- Swap Panel -->
    <section class="card panel" id="panel-swap">
      <h2>Swap</h2>
      <div class="row">
        <div class="col"><label class="label">Token In</label><select id="swapTokenIn"><option>USDC</option><option value="WETH">ETH</option></select></div>
        <div class="col"><label class="label">Amount In</label><input class="input" id="swapAmountIn" placeholder="0.0" /></div>
      </div>
      <div class="row">
        <div class="col"><label class="label">Token Out</label><select id="swapTokenOut"><option value="WETH">ETH</option><option>USDC</option></select></div>
        <div class="col"><label class="label">Slippage (%)</label><input class="input" id="swapSlippage" value="0.50" /></div>
      </div>
      <div class="row">
        <div class="col"><label class="label">Estimated Out</label><input class="input" id="swapEstimatedOut" disabled /></div>
      </div>
      <div class="row">
        <button class="btn" id="btnQuote">Get Quote</button>
        <button class="btn primary" id="btnSwap">Swap</button>
      </div>
    </section>
    <!-- Liquidity Panel -->
    <section class="card panel" id="panel-liquidity" style="display:none;">
      <h2>Liquidity Management</h2>
      <div class="section">
        <h3>Approvals</h3>
        <div class="row">
          <button class="btn" id="btnApproveUsdc">Approve USDC</button>
          <button class="btn" id="btnApproveEth">Approve ETH</button>
        </div>
      </div>

      <div class="section">
        <h3>Deposit</h3>
        <div class="row">
          <div class="col"><label class="label">USDC Amount</label><input class="input" id="liqUsdc" /></div>
          <div class="col"><label class="label">ETH Amount</label><input class="input" id="liqEth" /></div>
        </div>
        <button class="btn primary" id="btnProvide">Deposit</button>
      </div>
      <div class="section">
        <h3>Withdraw</h3>
        <div class="row">
          <div class="col"><label class="label">UELP to burn</label><input class="input" id="wdUelp" /></div>
          <button class="btn primary" id="btnWithdraw">Withdraw</button>
        </div>
      </div>
    </section>


    <!-- Admin Panel -->
    <section class="card panel" id="panel-admin" style="display:none;">
      <h2>Admin Panel</h2>

      <!-- <div class="section">
        <h3>Parameters</h3>
        <div class="row">
          <div class="col"><label class="label">Swap Fee (%)</label><input class="input" id="admSwapFee" /></div>
          <div class="col"><label class="label">Protocol Fee (%)</label><input class="input" id="admProtFee" /></div>
        </div>
        <div class="row">
          <div class="col"><label class="label">Min Liquidity (ppm)</label><input class="input" id="admMinPpm" /></div>
          <div class="col"><label class="label">Withdraw Cooldown (sec)</label><input class="input" id="admCooldown" /></div>
        </div>
        <div class="row">
          <button class="btn" id="btnLoadParams">Load Params</button>
          <button class="btn primary" id="btnSaveParams">Save Params</button>
        </div>
      </div> -->

      <div class="section">
        <h3>ProtocolReward</h3>
        <div class="row">
          <div class="col"><label class="label">Accrued USDC</label><input class="input" id="feeUsdc" disabled /></div>
          <div class="col"><label class="label">Accrued ETH</label><input class="input" id="feeEth" disabled /></div>
        </div>
        <div class="row">
          <button class="btn" id="btnRefreshFees">Refresh</button>
          <button class="btn primary" id="btnClaimFees">Claim Fees</button>
        </div>
        <!-- <div class="row"><div class="col"><label class="label">Address</label><input class="input" id="admPrAddr" /></div></div>
        <button class="btn primary" id="btnSetPr">Set ProtocolReward</button> -->
      </div>

      <!-- <div class="section">
        <h3>Rescue Tokens</h3>
        <div class="row">
          <div class="col"><label class="label">Token</label><input class="input" id="admRescueAddr" /></div>
          <div class="col"><label class="label">Amount</label><input class="input" id="admRescueAmt" /></div>
        </div>
        <button class="btn primary" id="btnRescue">Rescue Tokens</button>
      </div> -->
    </section>
    <section class="card panel" id="panel-about" style="display:none;">
      <h2>About iDex</h2>
      <p>
        <strong>iDex</strong> is a lightweight decentralized exchange (DEX) designed to demonstrate the 
        fundamental mechanics of Automated Market Makers (AMMs). It provides an intuitive interface 
        for swapping tokens, managing liquidity, and observing protocol-level operations.
      </p>
      <ul>
        <li><strong>Swap:</strong> Trade between ERC20 tokens (ETH / USDC) instantly with built-in slippage control.</li>
        <br />
        <li>
          <strong>Liquidity Management:</strong> 
          Deposit liquidity (ETH and USDC) to become a partial owner of the pool. In return, 
          <em>iDex</em> issues you <em>UELP</em> (User Exchange Liquidity Pool) tokens - 
          a native, non-fungible ERC-20 token of iDex. These tokens represent your 
          share of the pool and entitle you to a proportional share of swap fees and 
          protocol rewards. By holding UELP, you effectively own part of the pool and 
          can track, withdraw, or claim rewards based on your contribution. 
          <br />
        <br />
          Liquidity providers are able to withdraw their supplied tokens 
          after a minimum lock-up period of <strong>30 days</strong>, ensuring pool stability 
          and fairness for all participants.
          <br />
          <br />
          <em>Note: UELP tokens cannot be transferred or sold. They are strictly a representation of your liquidity position within iDex.</em>
        </li>
        <br />

        <li>
          <strong>Protocol Rewards:</strong> 
          Developers can earn and claim protocol fees that accrue from every swap. 
          A fixed <strong>5% of all swap fees</strong> are directed to the protocol’s 
          reward contract. These accumulated rewards can be periodically claimed, 
          providing developers with a sustainable incentive mechanism to maintain 
          and improve the protocol.  
          <br><br>
          <em>Note: Protocol Rewards are separate from liquidity provider (UELP) 
          earnings, ensuring both developers and liquidity providers are fairly compensated.</em>
        </li>
        

      </ul>
      <p>
        This project is a practical implementation of core DeFi principles, showcasing how 
        constant-product AMMs work and how liquidity providers are rewarded in a decentralized environment.
      </p>
    </section>
  </div>

  <script src="./index-ts.ts" type="module"> </script>
  <script>
    document.querySelectorAll("nav.menu a").forEach(link=>{
      link.addEventListener("click",e=>{
        document.getElementById("status").classList.add ("hidden");
        e.preventDefault();
        document.querySelectorAll("nav.menu a").forEach(a=>a.classList.remove("active"));
        link.classList.add("active");
        const target = link.dataset.target;
        document.querySelectorAll(".panel").forEach(p=>p.style.display="none");
        document.getElementById("panel-"+target).style.display="block";
      });
    });
  </script>
  <footer class="footer">
    © 2025 Md Solimul Chowdhury. All rights reserved. | 
    <a href="mailto:solimul.chowdhury@gmail.com">solimul.chowdhury@gmail.com</a>
  </footer>
</body>
</html>
