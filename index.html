<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>iDex • a Lightweight DEX</title>
  <style>
    :root {
      --bg: #0b0f14;
      --card: rgba(255,255,255,0.06);
      --card-border: rgba(255,255,255,0.08);
      --muted: #9bb3c7;
      --text: #e6eef6;
      --accent: #7cc8ff;
      --accent-2: #6ee7b7;
      --danger: #ef4444;
      --warning: #f59e0b;
      --success: #22c55e;
      --radius: 16px;
    }
    body {
      margin: 0; background: var(--bg); color: var(--text);
      font-family: Inter, sans-serif;
    }
    header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
  }

  .header-left {
    display: flex;
    flex-direction: column;
  }

  .subtitle {
    text-align: right;
    font-size: 13px;
    color: var(--muted);
  }

  .chain {
    font-family: 'Courier New', Courier, monospace;
    font-weight: bold;
  }

    .wrap { max-width: 1100px; margin: 0 auto; padding: 24px; }
    header { display:flex; justify-content:space-between; margin-bottom: 20px; }
    .kpis { display:grid; grid-template-columns: repeat(5,1fr); gap: 12px; margin-bottom: 20px; }
    .kpi { background: var(--card); border:1px solid var(--card-border); border-radius: var(--radius); padding: 14px; }
    .kpi .title { font-size: 12px; color: var(--muted); margin-bottom: 4px; }
    .kpi .value { font-size: 16px; font-weight: bold; }

    nav.menu { display:flex; justify-content:center; gap:24px; margin-bottom: 20px; }
    nav.menu a { color: var(--muted); text-decoration:none; font-weight:500; }
    nav.menu a.active { color: var(--accent); border-bottom: 2px solid var(--accent); padding-bottom: 2px; }

    .card { background: var(--card); border: 1px solid var(--card-border); border-radius: var(--radius); padding: 20px; margin: 0 auto; max-width: 800px; }
    .card h2 { margin-top:0; margin-bottom: 16px; }
    .row { display:flex; gap: 16px; margin-bottom: 14px; }
    .col { flex:1; display:flex; flex-direction:column; }
    .label { font-size: 12px; margin-bottom:6px; color: var(--muted); }
    .input, select { padding: 12px; border-radius: 12px; border:1px solid var(--card-border); background: rgba(10,13,18,.6); color: var(--text); }
    .btn { padding: 10px 16px; border-radius: 10px; border:1px solid var(--card-border); background: var(--card); cursor:pointer; color:var(--text); }
    .btn.primary { background: linear-gradient(135deg, rgba(124,200,255,.15), rgba(110,231,183,.15)); border-color: var(--accent); }
    .section { margin-bottom: 20px; padding-bottom: 12px; border-bottom: 1px solid rgba(255,255,255,0.08); }
    .section:last-child { border-bottom: none; }
    .status { margin-top: 8px; font-size: 16px; color: var(--muted); white-space: pre-wrap; max-height: 160px; overflow:auto; text-align:center; font-weight: bold; }
    .hidden {display: none;}
    .ok {color: green;}
    .err {color:red;}
    .wrn {color: orange;}
    .span {margin-right: 10px; margin-top:10px;}
    .chain {font-weight: bold;}
    .title {color:green; margin-top:0px;}
    .footer {
      margin-top: 40px;
      padding: 16px;
      text-align: center;
      font-size: 13px;
      color: var(--muted);
      border-top: 1px solid var(--card-border);
      background: rgba(255, 255, 255, 0.02);
      border-radius: var(--radius) var(--radius) 0 0;
      line-height: 1.6;
    }

    .footer a {
      color: var(--accent);
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }

    .footer code {
      font-family: 'Courier New', monospace;
      background: rgba(255, 255, 255, 0.08);
      padding: 2px 6px;
      border-radius: 6px;
      font-size: 12px;
      color: var(--text);
    }

    .contract-label {
      display: inline-block;
      margin-right: 6px;
      font-weight: 500;
      color: var(--muted);
    }
    .body {font-family: 'Courier New', Courier, monospace;}  
    .badge {
      display: inline-block;
      background-color: #f0f0f0;
      color: #333;
      padding: 2px 8px;
      margin: 4px 4px;
      border-radius: 8px;
      font-size: 0.85rem;
      font-weight: 500;
    }
</style>
</head>
<body class="body">
  <div class="wrap">
    <header>
      <div class="header-left">
        <h1 class="title">iDex: a lightweight decentralized exchange</h1>
        <div class="subtitle">
          <span class="chain" id="chain"></span>
        </div>
      </div>
      <div class="header-right">
        <button class="btn primary" id="btnConnect">Connect Wallet</button>
      </div>
    </header>
    

    <!-- KPI -->
    <div class="kpis">
      <div class="kpi"><div class="title">USDC Reserve</div><div class="value" id="kpiUsdc">–</div></div>
      <div class="kpi"><div class="title">ETH Reserve</div><div class="value" id="kpiEth">–</div></div>
      <div class="kpi"><div class="title">Accrued Swap Fees</div><div class="value" id="kpiSwapFees"></div> <div class="title"> </div></div>
      <div class="kpi"><div class="title">Price (USDC/ETH)</div><div class="value" id="kpiPrice">–</div></div>
      <div class="kpi"><div class="title">Your UELP</div><div class="value" id="kpiUelp">–</div></div>
    </div>

    <!-- Menu -->
    <nav class="menu">
      <a href="#" class="active" data-target="swap">Swap</a>
      <a href="#" data-target="liquidity">Liquidity Mgmt</a>
      <a href="#" data-target="admin">Admin</a>
      <a href="#" data-target="about">About iDex</a>

    </nav>

    <div class="section">
      <div id="status" class="status hidden"></div>
    </div>
    <!-- Swap Panel -->
    <section class="card panel" id="panel-swap">
      <h2>Swap</h2>
      <div class="row">
        <div class="col"><label class="label">Token In</label><select id="swapTokenIn"><option>USDC</option><option value="WETH">ETH</option></select></div>
        <div class="col"><label class="label">Amount In</label><input class="input" id="swapAmountIn" placeholder="0.0" /></div>
      </div>
      <div class="row">
        <div class="col"><label class="label">Token Out</label><select id="swapTokenOut"><option value="WETH">ETH</option><option>USDC</option></select></div>
        <div class="col"><label class="label">Slippage (%)</label><input class="input" id="swapSlippage" value="0.50" /></div>
      </div>
      <div class="row">
        <div class="col"><label class="label">Estimated Out</label><input class="input" id="swapEstimatedOut" disabled /></div>
      </div>
      <div class="row">
        <button class="btn" id="btnQuote">Get Quote</button>
        <button class="btn primary" id="btnSwap">Swap</button>
      </div>
    </section>
    <!-- Liquidity Panel -->
    <section class="card panel" id="panel-liquidity" style="display:none;">
      <h2>Liquidity Management</h2>
      <div class="section">
        <h3>Approvals</h3>
        <div class="row">
          <button class="btn" id="btnApproveUsdc">Approve USDC</button>
          <button class="btn" id="btnApproveEth">Approve ETH</button>
        </div>
      </div>

      <div class="section">
        <h3>Deposit</h3>
        <div class="row">
          <div class="col"><label class="label">USDC Amount</label><input class="input" id="liqUsdc" /></div>
          <div class="col"><label class="label">ETH Amount</label><input class="input" id="liqEth" /></div>
        </div>
        <button class="btn primary" id="btnProvide">Deposit</button>
      </div>
      <div class="section">
        <h3>Withdraw</h3>
        <div class="row">
          <div class="col"><label class="label">UELP to burn</label><input class="input" id="wdUelp" /></div>
          <button class="btn primary" id="btnWithdraw">Withdraw</button>
        </div>
      </div>
    </section>


    <!-- Admin Panel -->
    <section class="card panel" id="panel-admin" style="display:none;">
      <h2>Admin Panel</h2>

      <!-- <div class="section">
        <h3>Parameters</h3>
        <div class="row">
          <div class="col"><label class="label">Swap Fee (%)</label><input class="input" id="admSwapFee" /></div>
          <div class="col"><label class="label">Protocol Fee (%)</label><input class="input" id="admProtFee" /></div>
        </div>
        <div class="row">
          <div class="col"><label class="label">Min Liquidity (ppm)</label><input class="input" id="admMinPpm" /></div>
          <div class="col"><label class="label">Withdraw Cooldown (sec)</label><input class="input" id="admCooldown" /></div>
        </div>
        <div class="row">
          <button class="btn" id="btnLoadParams">Load Params</button>
          <button class="btn primary" id="btnSaveParams">Save Params</button>
        </div>
      </div> -->

      <div class="section">
        <h3>ProtocolReward</h3>
        <div class="row">
          <div class="col"><label class="label">Accrued USDC</label><input class="input" id="feeUsdc" disabled /></div>
          <div class="col"><label class="label">Accrued ETH</label><input class="input" id="feeEth" disabled /></div>
        </div>
        <div class="row">
          <button class="btn" id="btnRefreshFees">Refresh</button>
          <button class="btn primary" id="btnClaimFees">Claim Fees</button>
        </div>
        <!-- <div class="row"><div class="col"><label class="label">Address</label><input class="input" id="admPrAddr" /></div></div>
        <button class="btn primary" id="btnSetPr">Set ProtocolReward</button> -->
      </div>

      <!-- <div class="section">
        <h3>Rescue Tokens</h3>
        <div class="row">
          <div class="col"><label class="label">Token</label><input class="input" id="admRescueAddr" /></div>
          <div class="col"><label class="label">Amount</label><input class="input" id="admRescueAmt" /></div>
        </div>
        <button class="btn primary" id="btnRescue">Rescue Tokens</button>
      </div> -->
    </section>
    <section class="card panel" id="panel-about" style="display:none;font-family: 'Courier New', Courier, monospace;">
      <h2>About iDex</h2>
    
      <p>
        <strong>iDex</strong> is a decentralized exchange (DEX) that makes it easy to trade tokens 
        and understand how a constant product Automated Market Maker (AMM) works.  
        <br /><br />
        The protocol is powered by smart contracts written in Solidity and can be deployed on any Ethereum-compatible chain.  
        Whether you are new to DeFi or more experienced, iDex demonstrates the basics of token swaps, 
        liquidity pools, and rewards in a clear and practical way.
      </p>
    
      <ul>
        <li>
          <strong>Swap:</strong>  
          Imagine a neighborhood market where people can quickly exchange goods at fair prices.  
          iDex works the same way for tokens, letting anyone swap instantly without needing a middleman.  
          <br /><br />
          Behind the scenes, trades happen between ETH and USDC with built-in safeguards 
          to protect against large price changes (slippage).
        </li>
        <br />
    
        <li>
          <strong>Liquidity:</strong>  
          Think of neighbors pooling money into a shared garden. Everyone contributes, and when the garden produces, 
          they all share in the harvest.  
          <br /><br />
          On iDex, you add ETH and USDC to the pool and receive <em>UELP</em> tokens (minted by the protocol) showing your share. 
          By holding UELP, you earn a proportional share of swap fees.  
          These tokens can’t be transferred or sold; they simply record your position.  
          To keep the pool stable, withdrawals are only allowed after a <strong>30-day lock-up</strong>.
        </li>
        <br />
    
        <li>
          <strong>Rewards:</strong>  
          Just like setting aside part of a harvest for the gardeners who maintain the tools and soil, 
          iDex directs a small portion of fees to those who maintain the protocol.  
          <br /><br />
          Every swap generates fees: most go back to liquidity providers, while a fixed 
          <strong>5% of all swap fees</strong> are sent to a developer reward pool. 
          This ensures both the community and developers are fairly compensated.
        </li>
      </ul>
      <br />
      <hr style="margin: 20px 0; border: none; border-top: 1px solid #ccc;" />
      <br />
          <strong>Concrete Examples:</strong>
          <ul>
            <li>
              <strong>Swap Example:</strong>  
              A trader swaps <em>1,000 USDC</em> for ETH on iDex.  
              <br /><br />
              Suppose the pool currently holds:  
              <ul>
                <li>10 ETH</li>
                <li>20,000 USDC</li>
              </ul>
              The constant product is: <code>10 × 20,000 = 200,000</code>.  
              <br />
              After the swap, the pool’s USDC increases to <strong>21,000</strong>.  
              To keep the product constant (<code>x × y = 200,000</code>), the ETH balance must adjust to:  
              <code>200,000 ÷ 21,000 ≈ 9.52 ETH</code>.  
              <br /><br />
              This means the trader receives about <strong>0.48 ETH</strong> for their 1,000 USDC (before fees).  
              With a 0.3% fee applied, the pool actually records <strong>997 USDC</strong> as input and the trader receives slightly less ETH (~0.477 ETH).  
              <br /><br />
              In summary:  
              <ul>
                <li><em>Trader:</em> Pays 1,000 USDC → Receives ~0.477 ETH</li>
                <li><em>Pool:</em> Now holds ~9.52 ETH and 20,997 USDC</li>
                <li><em>Fees:</em> ~3 USDC added to the fee pool, later shared with liquidity providers</li>
              </ul>
            </li>
            <br />
        
            <li>
              <strong>Liquidity Example:</strong>  
              A user deposits <em>5 ETH</em> and <em>10,000 USDC</em> into the pool.  
              <br /><br />
              Suppose the pool initially holds:  
              <ul>
                <li>10 ETH</li>
                <li>20,000 USDC</li>
              </ul>
              Total pool value (at 1 ETH = 2,000 USDC) = <strong>40,000 USDC</strong>.  
              <br />
              The new deposit (5 ETH + 10,000 USDC) is worth <strong>20,000 USDC</strong>.  
              <br /><br />
              After the deposit, the pool holds:  
              <ul>
                <li>15 ETH</li>
                <li>30,000 USDC</li>
              </ul>
              Total value = <strong>60,000 USDC</strong>.  
              <br />
              This means the new liquidity provider owns <strong>20,000 ÷ 60,000 = 33.3%</strong> of the pool.  
              The protocol mints UELP tokens that represent this one-third ownership share.  
              <br /><br />
              Over the next month, suppose swaps generate <strong>900 USDC</strong> in fees (after protocol cut).  
              This user earns <strong>33.3% × 900 ≈ 300 USDC</strong> in fees, added to their withdrawal balance.  
              <br /><br />
              In summary:  
              <ul>
                <li><em>Deposit:</em> 5 ETH + 10,000 USDC</li>
                <li><em>Ownership:</em> ~33.3% of pool</li>
                <li><em>Monthly Fees:</em> ~300 USDC (credited to their position)</li>
              </ul>
            </li>
            
            <br />
        
            <li>
              <strong>Rewards Example:</strong>  
              Across hundreds of swaps in a week, the pool generates <strong>2,000 USDC</strong> in total fees.  
              <br /><br />
              From this amount:  
              <ul>
                <li><strong>1,900 USDC</strong> (95%) goes to liquidity providers, distributed in proportion to their share of the pool.</li>
                <li><strong>100 USDC</strong> (5%) goes to the developer reward pool.</li>
              </ul>
              <br />
              Suppose there are three liquidity providers:  
              <ul>
                <li>Provider A owns 50% of the pool → earns <strong>950 USDC</strong></li>
                <li>Provider B owns 30% of the pool → earns <strong>570 USDC</strong></li>
                <li>Provider C owns 20% of the pool → earns <strong>380 USDC</strong></li>
              </ul>
              Meanwhile, the protocol’s reward contract accumulates the remaining <strong>100 USDC</strong> for developers.  
              <br /><br />
              In summary:  
              <ul>
                <li><em>Total Fees:</em> 2,000 USDC</li>
                <li><em>Liquidity Providers:</em> 1,900 USDC shared proportionally</li>
                <li><em>Developers:</em> 100 USDC allocated for protocol maintenance</li>
              </ul>
            </li>
            
          </ul>
        
    
      <p>
        In short: iDex works like a shared project where people can trade, pool resources, 
        and share in the results — with everyone rewarded fairly for their role.
      </p>
    </section>
    
    
    
    
  </div>

  <script src="./index-ts.ts" type="module"> </script>
  <script>
    document.querySelectorAll("nav.menu a").forEach(link=>{
      link.addEventListener("click",e=>{
        document.getElementById("status").classList.add ("hidden");
        e.preventDefault();
        document.querySelectorAll("nav.menu a").forEach(a=>a.classList.remove("active"));
        link.classList.add("active");
        const target = link.dataset.target;
        document.querySelectorAll(".panel").forEach(p=>p.style.display="none");
        document.getElementById("panel-"+target).style.display="block";
      });
    });
  </script>
  <footer class="footer">
    © 2025 Md Solimul Chowdhury. All rights reserved. | 
    <a href="mailto:solimul.chowdhury@gmail.com">solimul.chowdhury@gmail.com</a>
    <br />
    <span class="contract-label">Smart Contract Deployed at:</span> 
    <a href="https://sepolia.etherscan.io/address/0x9f0847148f231f3138d446952e151e694844d507" 
      target="_blank" 
      rel="noopener">
      <code>0x9f0847148f231f3138d446952e151e694844d507</code>
    </a>
  </footer>
</body>
</html>
